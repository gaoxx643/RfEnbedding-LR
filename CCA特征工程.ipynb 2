{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "from sklearn.cross_decomposition import CCA,PLSCanonical, PLSRegression\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "读入体验和其他相关特征，统计周期一个星期。该数据由王凯提供。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "driver_exp_0 = pd.read_csv('driver_exp_features_1_15.csv')\n",
    "driver_exp_1 = pd.read_csv('driver_exp_features_16_70.csv')\n",
    "driver_exp_2 = pd.read_csv('driver_exp_features_70PLUS.csv')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "读入李盼的收入相关数据。该数据可以分为与特征同期和特征后一个星期。这里暂时使用特征后一个星期数据。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "driver_income0 = pd.read_table('features_driver_data_0730_0805.txt')\n",
    "driver_income1 = pd.read_table('features_driver_data_0806_0812.txt')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "读入饶东浩的安全label信息"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "unsafe = pd.read_table('0912_driver_mirror_case_cnt_0806_30d.csv', encoding='gbk', sep=',')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>driver_id</th>\n",
       "      <th>mirror_total_ord_dcnt</th>\n",
       "      <th>renshang_ord_dcnt</th>\n",
       "      <th>xingsaorao_ord_dcnt</th>\n",
       "      <th>sunhuicaiwu_ord_dcnt</th>\n",
       "      <th>shilian_ord_dcnt</th>\n",
       "      <th>cusi_ord_dcnt</th>\n",
       "      <th>qiangjie_ord_dcnt</th>\n",
       "      <th>daoqie_ord_dcnt</th>\n",
       "      <th>bangjiaqiaozha_ord_dcnt</th>\n",
       "      <th>shedu_ord_dcnt</th>\n",
       "      <th>weiguiyunxing_ord_dcnt</th>\n",
       "      <th>qianzaifengxian_ord_dcnt</th>\n",
       "      <th>weixie_ord_dcnt</th>\n",
       "      <th>shipinanquan_ord_dcnt</th>\n",
       "      <th>weixieanquan_ord_dcnt</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>580542545253297</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>567950132367235</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>565931240067699</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>566437054391715</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>563348738670594</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         driver_id  mirror_total_ord_dcnt  renshang_ord_dcnt  \\\n",
       "0  580542545253297                      1                  0   \n",
       "1  567950132367235                      1                  0   \n",
       "2  565931240067699                      1                  0   \n",
       "3  566437054391715                      1                  0   \n",
       "4  563348738670594                      1                  0   \n",
       "\n",
       "   xingsaorao_ord_dcnt  sunhuicaiwu_ord_dcnt  shilian_ord_dcnt  cusi_ord_dcnt  \\\n",
       "0                    0                     0                 0              0   \n",
       "1                    0                     0                 0              0   \n",
       "2                    0                     0                 0              0   \n",
       "3                    0                     0                 0              0   \n",
       "4                    0                     0                 0              0   \n",
       "\n",
       "   qiangjie_ord_dcnt  daoqie_ord_dcnt  bangjiaqiaozha_ord_dcnt  \\\n",
       "0                  0                0                        0   \n",
       "1                  0                0                        0   \n",
       "2                  0                0                        1   \n",
       "3                  0                0                        1   \n",
       "4                  0                0                        0   \n",
       "\n",
       "   shedu_ord_dcnt  weiguiyunxing_ord_dcnt  qianzaifengxian_ord_dcnt  \\\n",
       "0               0                       0                         0   \n",
       "1               0                       0                         0   \n",
       "2               0                       0                         0   \n",
       "3               0                       0                         0   \n",
       "4               0                       0                         0   \n",
       "\n",
       "   weixie_ord_dcnt  shipinanquan_ord_dcnt  weixieanquan_ord_dcnt  \n",
       "0                1                      0                      0  \n",
       "1                1                      0                      0  \n",
       "2                0                      0                      0  \n",
       "3                0                      0                      0  \n",
       "4                1                      0                      0  "
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "unsafe.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>city_id</th>\n",
       "      <th>driver_id</th>\n",
       "      <th>online_time_avg</th>\n",
       "      <th>iph</th>\n",
       "      <th>tph</th>\n",
       "      <th>online_time_std</th>\n",
       "      <th>iph_std</th>\n",
       "      <th>tph_std</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>562950053805082</td>\n",
       "      <td>0.016667</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>562950053934600</td>\n",
       "      <td>1.591667</td>\n",
       "      <td>39.326702</td>\n",
       "      <td>0.628272</td>\n",
       "      <td>0.141667</td>\n",
       "      <td>3.130802</td>\n",
       "      <td>0.056366</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>562950054408618</td>\n",
       "      <td>10.844444</td>\n",
       "      <td>63.006762</td>\n",
       "      <td>1.321721</td>\n",
       "      <td>1.278406</td>\n",
       "      <td>3.023289</td>\n",
       "      <td>0.593122</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>562950054466944</td>\n",
       "      <td>1.233333</td>\n",
       "      <td>46.045946</td>\n",
       "      <td>1.297297</td>\n",
       "      <td>1.097927</td>\n",
       "      <td>19.540659</td>\n",
       "      <td>0.361714</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>562950054486958</td>\n",
       "      <td>4.066667</td>\n",
       "      <td>43.924590</td>\n",
       "      <td>2.090164</td>\n",
       "      <td>2.473096</td>\n",
       "      <td>12.092422</td>\n",
       "      <td>0.387330</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   city_id        driver_id  online_time_avg        iph       tph  \\\n",
       "0        1  562950053805082         0.016667   0.000000  0.000000   \n",
       "1        1  562950053934600         1.591667  39.326702  0.628272   \n",
       "2        1  562950054408618        10.844444  63.006762  1.321721   \n",
       "3        1  562950054466944         1.233333  46.045946  1.297297   \n",
       "4        1  562950054486958         4.066667  43.924590  2.090164   \n",
       "\n",
       "   online_time_std    iph_std   tph_std  \n",
       "0         0.000000   0.000000  0.000000  \n",
       "1         0.141667   3.130802  0.056366  \n",
       "2         1.278406   3.023289  0.593122  \n",
       "3         1.097927  19.540659  0.361714  \n",
       "4         2.473096  12.092422  0.387330  "
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "driver_income0.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "查看数据的基本维度信息"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(3143263, 8)\n",
      "2825534\n"
     ]
    }
   ],
   "source": [
    "print(driver_income0.shape)\n",
    "\n",
    "print(driver_exp_0.shape[0]+driver_exp_1.shape[0]+driver_exp_2.shape[0])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(2825534, 159)"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "expall = pd.concat([driver_exp_0, driver_exp_1, driver_exp_2])\n",
    "ids = expall.driver_id\n",
    "expall.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>driver_id</th>\n",
       "      <th>cnt_respond_orders_7d</th>\n",
       "      <th>cnt_pinche_orders_7d</th>\n",
       "      <th>cnt_appointment_orders_7d</th>\n",
       "      <th>cnt_morning_peak_orders_7d</th>\n",
       "      <th>cnt_normal_peak_orders_7d</th>\n",
       "      <th>cnt_evening_peak_orders_7d</th>\n",
       "      <th>cnt_cancel_orders_7d</th>\n",
       "      <th>cnt_cancel_by_p_orders_7d</th>\n",
       "      <th>cnt_grab_after_cancel_by_p_orders_7d</th>\n",
       "      <th>...</th>\n",
       "      <th>cnt_driver_star_feedback_5star_7d</th>\n",
       "      <th>cnt_passenger_complaint_7d</th>\n",
       "      <th>cnt_passenger_complaint_result_succeed_7d</th>\n",
       "      <th>cnt_passenger_complaint_result_failed_7d</th>\n",
       "      <th>cnt_driver_complaint_7d</th>\n",
       "      <th>cnt_driver_complaint_result_succeed_7d</th>\n",
       "      <th>cnt_driver_complaint_result_failed_7d</th>\n",
       "      <th>cnt_questionary_comment_order_7d</th>\n",
       "      <th>cnt_questionary_comment_positive_answer_7d</th>\n",
       "      <th>cnt_questionary_comment_negative_answer_7d</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>580542259157740</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>580542259165490</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>2.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3</td>\n",
       "      <td>2.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>580542259165990</td>\n",
       "      <td>14</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>5</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>580542259166070</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>580542259170593</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>3.0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 159 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "         driver_id  cnt_respond_orders_7d  cnt_pinche_orders_7d  \\\n",
       "0  580542259157740                      1                     0   \n",
       "1  580542259165490                      3                     0   \n",
       "2  580542259165990                     14                     0   \n",
       "3  580542259166070                      1                     0   \n",
       "4  580542259170593                      3                     1   \n",
       "\n",
       "   cnt_appointment_orders_7d  cnt_morning_peak_orders_7d  \\\n",
       "0                          0                         1.0   \n",
       "1                          1                         2.0   \n",
       "2                          0                         5.0   \n",
       "3                          0                         NaN   \n",
       "4                          0                         NaN   \n",
       "\n",
       "   cnt_normal_peak_orders_7d  cnt_evening_peak_orders_7d  \\\n",
       "0                        NaN                         NaN   \n",
       "1                        1.0                         NaN   \n",
       "2                        9.0                         NaN   \n",
       "3                        1.0                         NaN   \n",
       "4                        3.0                         NaN   \n",
       "\n",
       "   cnt_cancel_orders_7d  cnt_cancel_by_p_orders_7d  \\\n",
       "0                     0                        NaN   \n",
       "1                     3                        2.0   \n",
       "2                     5                        5.0   \n",
       "3                     0                        NaN   \n",
       "4                     2                        1.0   \n",
       "\n",
       "   cnt_grab_after_cancel_by_p_orders_7d  \\\n",
       "0                                   NaN   \n",
       "1                                   2.0   \n",
       "2                                   5.0   \n",
       "3                                   NaN   \n",
       "4                                   1.0   \n",
       "\n",
       "                      ...                      \\\n",
       "0                     ...                       \n",
       "1                     ...                       \n",
       "2                     ...                       \n",
       "3                     ...                       \n",
       "4                     ...                       \n",
       "\n",
       "   cnt_driver_star_feedback_5star_7d  cnt_passenger_complaint_7d  \\\n",
       "0                                  0                           0   \n",
       "1                                  0                           0   \n",
       "2                                  0                           0   \n",
       "3                                  0                           0   \n",
       "4                                  0                           0   \n",
       "\n",
       "   cnt_passenger_complaint_result_succeed_7d  \\\n",
       "0                                        NaN   \n",
       "1                                        NaN   \n",
       "2                                        NaN   \n",
       "3                                        NaN   \n",
       "4                                        NaN   \n",
       "\n",
       "   cnt_passenger_complaint_result_failed_7d  cnt_driver_complaint_7d  \\\n",
       "0                                       NaN                        0   \n",
       "1                                       NaN                        0   \n",
       "2                                       NaN                        0   \n",
       "3                                       NaN                        0   \n",
       "4                                       NaN                        0   \n",
       "\n",
       "   cnt_driver_complaint_result_succeed_7d  \\\n",
       "0                                     NaN   \n",
       "1                                     NaN   \n",
       "2                                     NaN   \n",
       "3                                     NaN   \n",
       "4                                     NaN   \n",
       "\n",
       "   cnt_driver_complaint_result_failed_7d  cnt_questionary_comment_order_7d  \\\n",
       "0                                    NaN                                 1   \n",
       "1                                    NaN                                 0   \n",
       "2                                    NaN                                 0   \n",
       "3                                    NaN                                 1   \n",
       "4                                    NaN                                 0   \n",
       "\n",
       "   cnt_questionary_comment_positive_answer_7d  \\\n",
       "0                                         NaN   \n",
       "1                                         NaN   \n",
       "2                                         NaN   \n",
       "3                                         NaN   \n",
       "4                                         NaN   \n",
       "\n",
       "   cnt_questionary_comment_negative_answer_7d  \n",
       "0                                         NaN  \n",
       "1                                         NaN  \n",
       "2                                         NaN  \n",
       "3                                         NaN  \n",
       "4                                         NaN  \n",
       "\n",
       "[5 rows x 159 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "expall.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "y = pd.merge(pd.DataFrame(ids), unsafe, on='driver_id', how='left')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "expall.fillna(0, inplace=True)\n",
    "x = expall.iloc[:, 1:]\n",
    "y.fillna(0, inplace=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "cnt_respond_orders_7d                                    int64\n",
       "cnt_pinche_orders_7d                                     int64\n",
       "cnt_appointment_orders_7d                                int64\n",
       "cnt_morning_peak_orders_7d                             float64\n",
       "cnt_normal_peak_orders_7d                              float64\n",
       "cnt_evening_peak_orders_7d                             float64\n",
       "cnt_cancel_orders_7d                                     int64\n",
       "cnt_cancel_by_p_orders_7d                              float64\n",
       "cnt_grab_after_cancel_by_p_orders_7d                   float64\n",
       "cnt_grab_before_cancel_by_p_orders_7d                  float64\n",
       "cnt_cancel_by_d_orders_7d                              float64\n",
       "cnt_cancel_final_result_driver_duty_7d                 float64\n",
       "cnt_cancel_by_p_final_result_driver_duty_7d            float64\n",
       "cnt_cancel_by_d_final_result_driver_duty_7d            float64\n",
       "cnt_cancel_result_is_reduce_driver_deal_rate_7d        float64\n",
       "cnt_cancel_result_is_reduce_driver_service_score_7d    float64\n",
       "cnt_cancel_result_driver_duty_penalty_7d               float64\n",
       "sum_cancel_result_driver_duty_penalty_amount_7d        float64\n",
       "cnt_cancel_final_result_passenger_duty_7d              float64\n",
       "cnt_cancel_by_p_final_result_passenger_duty_7d         float64\n",
       "cnt_cancel_by_d_final_result_passenger_duty_7d         float64\n",
       "cnt_cancel_result_passenger_is_duty_penalty_7d         float64\n",
       "sum_cancel_result_passenger_duty_penalty_amount_7d     float64\n",
       "cnt_cancel_driver_induced_cancel_order_7d              float64\n",
       "cnt_empty_drive_compensate_orders_7d                   float64\n",
       "cnt_empty_drive_compensate_orders_platform_cost_7d     float64\n",
       "cnt_empty_drive_compensate_orders_passenger_cost_7d    float64\n",
       "sum_empty_drive_compensation_7d                        float64\n",
       "sum_empty_drive_distance_7d                            float64\n",
       "sum_empty_drive_platform_cost_7d                       float64\n",
       "                                                        ...   \n",
       "cnt_appeal_qiedan_fixed_7d                             float64\n",
       "cnt_appeal_qiedan_fixed_penalty_7d                     float64\n",
       "cnt_appeal_qiedan_fixed_service_score_7d               float64\n",
       "cnt_order_may_appeal_7d                                float64\n",
       "cnt_deal_rate_may_appeal_7d                            float64\n",
       "cnt_penalty_may_appeal_7d                              float64\n",
       "cnt_service_score_may_appeal_7d                        float64\n",
       "cnt_unpaid_may_appeal_7d                               float64\n",
       "cnt_qiedan_may_appeal_7d                               float64\n",
       "cnt_passenger_star_feedback_7d                           int64\n",
       "cnt_passenger_star_feedback_1star_7d                     int64\n",
       "cnt_passenger_star_feedback_2star_7d                     int64\n",
       "cnt_passenger_star_feedback_3star_7d                     int64\n",
       "cnt_passenger_star_feedback_4star_7d                     int64\n",
       "cnt_passenger_star_feedback_5star_7d                     int64\n",
       "cnt_driver_star_feedback_7d                              int64\n",
       "cnt_driver_star_feedback_1star_7d                        int64\n",
       "cnt_driver_star_feedback_2star_7d                        int64\n",
       "cnt_driver_star_feedback_3star_7d                        int64\n",
       "cnt_driver_star_feedback_4star_7d                        int64\n",
       "cnt_driver_star_feedback_5star_7d                        int64\n",
       "cnt_passenger_complaint_7d                               int64\n",
       "cnt_passenger_complaint_result_succeed_7d              float64\n",
       "cnt_passenger_complaint_result_failed_7d               float64\n",
       "cnt_driver_complaint_7d                                  int64\n",
       "cnt_driver_complaint_result_succeed_7d                 float64\n",
       "cnt_driver_complaint_result_failed_7d                  float64\n",
       "cnt_questionary_comment_order_7d                         int64\n",
       "cnt_questionary_comment_positive_answer_7d             float64\n",
       "cnt_questionary_comment_negative_answer_7d             float64\n",
       "Length: 158, dtype: object"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "x.dtypes"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "下面试试随机森林算法和随机森林映射后采用逻辑斯特回归的方法。Kfold交叉验证。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/didi/anaconda3/lib/python3.6/site-packages/sklearn/cross_validation.py:41: DeprecationWarning: This module was deprecated in version 0.18 in favor of the model_selection module into which all the refactored classes and functions are moved. Also note that the interface of the new CV iterators are different from that of this module. This module will be removed in 0.20.\n",
      "  \"This module will be removed in 0.20.\", DeprecationWarning)\n"
     ]
    }
   ],
   "source": [
    "from sklearn.ensemble import (RandomTreesEmbedding, RandomForestClassifier, GradientBoostingClassifier)\n",
    "from sklearn.metrics import roc_curve, roc_auc_score\n",
    "from sklearn import cross_validation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['driver_id', 'mirror_total_ord_dcnt', 'renshang_ord_dcnt',\n",
       "       'xingsaorao_ord_dcnt', 'sunhuicaiwu_ord_dcnt', 'shilian_ord_dcnt',\n",
       "       'cusi_ord_dcnt', 'qiangjie_ord_dcnt', 'daoqie_ord_dcnt',\n",
       "       'bangjiaqiaozha_ord_dcnt', 'shedu_ord_dcnt', 'weiguiyunxing_ord_dcnt',\n",
       "       'qianzaifengxian_ord_dcnt', 'weixie_ord_dcnt', 'shipinanquan_ord_dcnt',\n",
       "       'weixieanquan_ord_dcnt'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[Parallel(n_jobs=-1)]: Done  42 tasks      | elapsed:   42.0s\n",
      "[Parallel(n_jobs=-1)]: Done 192 tasks      | elapsed:  2.9min\n",
      "[Parallel(n_jobs=-1)]: Done 200 out of 200 | elapsed:  3.0min finished\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "RandomForestClassifier(bootstrap=True, class_weight=None, criterion='gini',\n",
       "            max_depth=3, max_features='auto', max_leaf_nodes=None,\n",
       "            min_impurity_decrease=0.0, min_impurity_split=None,\n",
       "            min_samples_leaf=1, min_samples_split=2,\n",
       "            min_weight_fraction_leaf=0.0, n_estimators=200, n_jobs=-1,\n",
       "            oob_score=False, random_state=None, verbose=1,\n",
       "            warm_start=False)"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "n_estimator = 200\n",
    "rf = RandomForestClassifier(max_depth=3, n_estimators=n_estimator, n_jobs=-1, verbose=1)\n",
    "yall = (y.mirror_total_ord_dcnt>0)*1.0\n",
    "ysex = ((y.xingsaorao_ord_dcnt+y.weixie_ord_dcnt+y.weixieanquan_ord_dcnt)>0)*1.0\n",
    "rf.fit(x, ysex)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "效果不错，猜测有一个变量跟涉性投诉有较强关系（不一定是线性相关性）。这里没有深究。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[Parallel(n_jobs=4)]: Done  42 tasks      | elapsed:    2.3s\n",
      "[Parallel(n_jobs=4)]: Done 192 tasks      | elapsed:    9.4s\n",
      "[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    9.8s finished\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.8231357248552486\n"
     ]
    }
   ],
   "source": [
    "# The random forest model by itself\n",
    "y_pred_rf = rf.predict_proba(x)[:, 1]\n",
    "fpr_rf, tpr_rf, _ = roc_curve(yall, y_pred_rf)\n",
    "auc = roc_auc_score(ysex, y_pred_rf)\n",
    "print(auc)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYoAAAEWCAYAAAB42tAoAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMS4yLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvNQv5yAAAIABJREFUeJzs3Xd4FWX2wPHvSQiEFqpSQghFFEKHSJMqRaqgIE0hdOsP1y6ru5Z1saxt3aUKKsvKomsDFAUVAZHeS+gtJPQSIJB+398fM8SQTcIl5GbuvTmf57kPd8qdORmSOXfe950zYoxBKaWUykmA0wEopZTybpoolFJK5UoThVJKqVxpolBKKZUrTRRKKaVypYlCKaVUrjRRKL8hIhEist7pOPJKRJaKyJgclv1RRGYUdEwFQUSMiNzi5roPi8gJEUkQkQrZLG8kIivzP8rCTROFDxORQyKSaP/RHBeRT0SkVJZ12ojIEhG5KCLnRWSBiERkWSdERN4XkRh7W/vs6YoF+xPdsL8AbzsdhCcYYyYaY7JNIjdCRGrYJ+oiuazzsoj8O7/3fb1EJAh4F+hmjClljDmTNckYY7YC8SLSx7FA/ZAmCt/XxxhTCmgCNAUmXFkgIq2BxcA8oCpQE9gC/CYitex1igI/A/WB7kAI0AY4A7TwVNC5nZjyuL0qQCfgm/zcrvIqlYBgYMc11vsUeNDz4RQixhh9+egLOAR0yTT9FvBdpulfgcnZfO574F/2+zHACaDUdey3PvAjcNb+7B/t+Z8Ar2VaryMQmyXe54CtQDLwIvBFlm3/HfjAfl8GmAkcA+KA14DAHGIaDvyUaXoQkJDplQwszbTdfwGngMN2HAH2sgB7+jBw0l6vjL2sBmCAkcAR4BzwEHC7/TPFA//MEtcoYKe97iIgPNOyrsAu4DzwT2AZMCaHn+9l4N9Z4ogCYoDTwAu5/H/1AjYBF+y4X860LMbe1pXj1DrLZ7sDKUCqvXyLPb8qMN/+HdgHjM0S6xfAZ8BFYCPQOJf4DHCL/b4Y1lVhjP27NRUoDtwKXMoU6xJguT19yZ43yN5GKJAIFHP6b9RfXo4HoK8b+M/LlCiAasA24O/2dAkgHeiUzedGAsfs93OBWdexz9JYJ+6nsL7dlQZa2ss+4dqJYjMQZv/xhwOXgRB7eaC97Vb29DfANKAkcDOwFngwh7j+BkzKYVkI1sn6QXv6X1hXWaXtk+4eYLS9bJR94qsFlAK+Ambby2rYJ6ap9s/eDUiy47zZPkGdBDrY6/ezt1UPKIKVgFbayypinbgHAEHAE0Aa15coPrSPY2OsRFgvh892BBpiJcFGWCfgflm2VSSX//OMfWeatwyYbB+HJlhJt3Om9VMz/WxPAweBoBy2nzlRvI+VgMrb/z8LgNdzijXzZ7Ns8wLQyOm/UX95OR6Avm7gP8868SZgfWszWE1IZe1l1ex5dbP5XHcg1X7/I/DGdexzCLAph2WfcO1EMSrLZ1YAw+33XYH99vtK9smveJZ9/5LDvj/M7uewT47fAlPs6UB7uxGZ1nmQ3682fgYeybTsNvukVyTTiSo00/Iz2N9k7ekvgT/Y77/HTkCZYrmMlSCHA6szLRMglutLFNUyLV8LDHbz//B94L0s23I7UWAl+nSgdKZ5rwOfZFo/888WgPUFoF0O2zfALfYxuATUzrSsNXAwp1jJOVHEAe0L4u+wMLy0j8L39TPGlMY6KdfF+qYKVlOHC6iSzWeqYDVXgHWiy26dnIQB+/MUqeVIluk5WAkAYKg9DdbJNAg4JiLxIhKPdXVxcw7bPYf1DTSrv9rzx9vTFYGiWE1LVxzGuhoAq0kl67IiWInrihOZ3idmM31lQEE48PdM8Z/FOhmG2vvJOBbGOrtlPTbXcjzT+8uZ9nsVEWkpIr+IyCkROY/VXHYjAxWqAmeNMRczzct8DOHqn82FlQSrXmO7N2FdCW/IdMx+sOdfr9JYTYEqH2ii8BPGmGVY3+jftqcvAauA+7JZfSDWN2eAn4C7RKSkm7s6AtTOYdklrD/0KypnF2qW6f8CHUWkGnAPvyeKI1jf/CsaY8rarxBjTP0c9r0Vqx07g4gMxkpCA4wxqfbs01hXCOGZVq2O9Q0U4Gg2y9K4Ohm46whWc1fZTK/ixpiVWN+wwzLFKpmn89kcrOacMGNMGaymM7GXZf3/yE7WdY4C5UUkc2LOfAzh6p8tAOsK9+g19nMaK9HWz3S8yhhrsIbbRKQq1peB3dfzOZUzTRT+5X2gq4g0saefB6JEZLyIlBaRciLyGtbl/Cv2OrOxTmhfikhdEQkQkQr2uP2e2ezjW6CyiPxBRIrZ221pL9sM9BSR8iJSGfjDtQI2xpwClgIfYzUx7LTnH8MasfWOPXw3QERqi0iHHDb1I9BMRIIBRKQp8A+sK65TmfaXDnwO/NWOPRx4Ergy/PM/wBMiUtMeajwR+MwYk3atnyUbU4EJIlLfjqmMiFxJ3N8B9UXkXnsE2HiyT6z5oTTWFUCSiLTAunK74hTWlWetXD5/Aqhhn/AxxhwBVgKvi0iwiDQCRmONNrqieaaf7Q9YSX91bkHaVx4fAu+JyM0AIhIqInddI7assXcElhhjknPbn3KfJgo/Yp8Q/wX8yZ5eAdwF3Iv1DfYw1hDatsaYvfY6yUAXrNE3P2J1Aq7FappYk80+LmL1JfTBavrYizUsFaykswWrL2Ix1qgXd8yxY5iTZf5wrG+G0VhNS1+QQzOZMeYE1kiYvvasvkA5YIV9b0iCiHxvL/s/rKufA1h9JHOAj+xlH9k/x3KsDtgke/3rZoz5GngTmCsiF4DtQA972Wmsq703sJr/6gC/5WU/bngEeFVELgJ/xkqUV2K8jNU895vd3NMqm8//1/73jIhstN8PweozOAp8DbxkjPkx02fmYY08OwcMA+7NdFWXm+ewBgCsto/ZT1j9RDl5GZhlxz7Qnnc/VpJW+UTsjh+lfJ59I+EsoIXRX2zHiMjLWB3MDziw74bAdGNM64Letz/L15uelHKSMSYa654GVUgZY7ZhNa2qfOSxpicR+UhETorI9hyWi4h8YJeL2CoizTwVi1JKqbzzWNOTiLTHGuP/L2NMg2yW98Rq++0JtMS6Uaxl1vWUUko5y2NXFMaY5VjjxnPSFyuJGGPMaqCsXa9HKaWUF3GyjyKUq28wirXnHcu6ooiMA8YBlCxZsnndunULJECllPIGBkhLN6S7XKS5DGnphjT7fXq6sea5XPZ8gyublqKU4/tOG2PycvOio4lCspmXbTuYMWY6MB0gMjLSrF/vs48cUEop0tJdnLucyplLyZxNSOH0pRTOJiRz5lKK9UpI5uylFM4kpHA6IZkLSdnfxhMcIJQrWZQKJYtSsVQxypcsSoVSRa1/SxalQqliLF/8HYnxp3jv1QmHs92IG5xMFLFcfSeqO3duKqWU13G5DPGJqZy5crJPSOHspWROJ6RYyeBSCqcTUuyTfzLxialk1z0cIFC+5JUTfTHqVQ2hon3CL1+yKBVLFaV8yWJUKGUlgpDgIAICrv7OHRcXx8MPP8ygQYO46/77uav+aADee3XC/+7QTU4mivnAYyIyF6sz+7x9N65SSjnKGMOFxDROX0q+6qR/5UT/ezL4PRG4chgXVK5EkP1Nvxi3VipF+VrlqZBxsv89AVQoVYwyxYMIDMiuscW9mGfMmMHTTz9NamoqvXr1uoEjcDWPJQoR+Q/WrfQVRSQWeAmryBvGmKnAQqwRT/uwCpqN9FQsSqnCKSXNxYWkVC4kpnIhKY3ziVfep3Ih0Z62l8dfTuW03eRz9lIKaTmc+UOCi2Q089SoWIJm4eXsb/rWyb5iyaKUt5NAuRJBFAn0fAGM/fv3M3bsWH755Rc6derEhx9+SO3aOZVku34eSxTGmCHXWG6AR/NjX6mpqcTGxpKUlJQfmytwwcHBVKtWjaCgIKdDUcpnGGM4cymFo/GJHI1PJC4+yfr3XCJHz1vzTiek5LqNoEChTPEgQoKDKFMiiGrlStAkrGzGSb9Cpjb/iqWKUa5EUYoW8b7KR9u2bWPDhg1Mnz6dMWPGYNWYzD9+cWd2bGwspUuXpkaNGvl+gDzNGMOZM2eIjY2lZs2aToejlFc5fj6JlftPs/PYBXYdv0j85VRS012kpLk4fiGJyynpV61fPCiQ0HLFqVq2OPWrhlA5pDjlStqJoHgQIcWLEBIcREhxa7pYkQCfO2dcsX37djZu3Mjw4cPp168fBw4coEKFCh7Zl18kiqSkJJ9MEgAiQoUKFTh16tS1V1bKz6S7DDuOnmdr7Hk2HD7HqYvJXEhK5Wh8EheSUklJcwFQtEgA1coWJ7xCCYoWCSAoMIC2dSpSq2JJqpa1EkNo2eKULRHkk+eB65GSksLEiROZOHEilSpVYuDAgQQHB3ssSYCfJArAp385fDl2pdzhchn2nLzIuUup7Dh6nuV7T3PqYjJx5y5nDP2sFFKMqmWLU6Z4ENXLlyC0XHFuKlWMVrUqULdy6QJp6/d2a9asYfTo0ezYsYMHHniA9957j+DgYI/v128ShVLKWcYY9p+6xIkLSZy8mMTR+CTi4hPZdzKBuHOJxMUnZqwbXqEEdW4uRZOwsrSqVZ7G1coSXqGEfmnKRVxcHO3ataNSpUp8++23+Tqq6Vo0UeSTwMBAGjZsSFpaGjVr1mT27NmULVuWQ4cOUa9ePW677feS+mvXrqVo0aIORqvUjTt5MYk9xxM4dj6RfacS+HHHCQ6cvnTVOmVLBFGtXHFurVSKqDbhNKhahvCKJQktW9yhqH3Pnj17uPXWWwkNDeWzzz6jc+fOhISEFGgMmijySfHixdm8eTMAUVFRTJo0iRdeeAGA2rVrZyxTylccPnOJLzbEkppuOHkxibOXUriUnJZxpZBVo2pleLFXPRqGlqF0cBA1K5akeNFAByL3D/Hx8Tz77LPMmDGDpUuX0r59e+655x5HYtFE4QGtW7dm69atToeh1DWluwzRRy+w58RFjl9I4tTFZE4lJHMxKY3le34fYFG+ZFEqhwRTOrgIjaqVoWtEJdJcLu6qX5mbSwcTXqEEwUGaFPLL/Pnzefjhhzl+/DjPPPMMt9/u7GNW/C5RvLJgB9FHL+TrNiOqhvBSn/purZuens7PP//M6NGjM+bt37+fJk2sx1jfcccdTJo0KV/jUyorl8uQlJbOpeR0jsYncujMJTYfiedMQgrxiamcv2z9e+JCEkmprozPBQUKVcsWp1SxInSvX5nhrcNpXbuC9h0UoDFjxjBz5kwaNmzIvHnziIyMdDok/0sUTklMTKRJkyYcOnSI5s2b07Vr14xl2vSkPO1ofCLb4s6zdPcpdh67wJbY+P+pJRQgEFa+BGVLFKVsiaLUqFiSssWDiKgaQsPQstS6qaRP31fgy648F0hEiIyMJDw8nOeee85r+jL9LlG4+80/v13pozh//jy9e/dm0qRJjB8/3pFYlP/bcPgcMWcvsfFwPCv2neZglk7k22uUo3O9SgQXCaBi6WLcVKoYDULLULKY3/3J+7wjR47w0EMPMXjwYIYNG8ZDDz3kdEj/Q39r8lmZMmX44IMP6Nu3Lw8//LDT4Sg/sfPYBRbtOE7Mmct8tSnuqmVNwsoypEV17mkayq2VSlG2hHd8C1W5c7lcTJs2jeeee4709HTHOqrdoYnCA5o2bUrjxo2ZO3cu7dq1czoc5eVS0lxsjY1n78kEDp2+xKWUtIy+hcNnLnPmUjKp6b+3I3W49SZqVizJfZHV7LuRNTH4mr179zJmzBiWL19Oly5dmD59uleX8NFEkU8SEhKuml6wYEHG++3btxd0OMqLXUxKZenuUyzbc4q9JxPYciT+quXlSxYluEgAFUoVo3l4OaqVL07lkGDa1alIjQol9Q5lPxAdHc3WrVv56KOPGDFihNf3C2miUMqDtsWe56tNsew+fpGk1HTOXU79n/6E4a3DqVwmmBY1ytOoWlmvrE6qbtyWLVvYvHkzUVFR9O3blwMHDlCuXDmnw3KLJgql8lm6y7Bgy1E+Xnko42qhRoUSVCtXgvIli9G9QWUiw8vRomZ5ShUr4vXfJtWNSU5O5rXXXuONN96gSpUqDBo0iODgYJ9JEuBHicIY47N/cCa7ZyIqn3HsfCIbDp/j1z2nOXz2EjviLnAx2Sp092CHWkS1rkFVLVlRKK1atYrRo0ezc+dOhg8fzrvvvlsgRfzym18kiuDgYM6cOUOFCr53Y9CV51H44i9PYXfw9CVGf7LuqvpGVcoE06nuzTQMLcOgFmGEBOvDqAqruLg4OnToQOXKlVm4cCE9evRwOqQ884tEUa1aNWJjY332mQ5XnnCnvF9auotpyw/w+fojHD5zOWP+f8a2ol6V0joCSbFz507q1atHaGgon3/+OZ07d6Z06dJOh3VD/CJRBAUFefXQMuXb9p28yMSFu1h38GxGkxLA8z3q0qthFcLKl3AwOuUtzp07x1NPPcXHH3/M8uXLadeuHf369XM6rHzhF4lCqfyW7jLMWnmIrzfFsS3uPAAV7bub291akbHtahGkw1SV7euvv+aRRx7h1KlTTJgwwfEifvlNE4VSmaw7dJZPfjvExphzHDufBMBd9Ssxrn1tmof7zigVVXBGjRrFxx9/TJMmTfjuu+9o1qyZ0yHlO00UqtA7dj6R77YeY8W+0yzdbfVzhQQX4Q9d6vB/d9YhMMC3Bkgoz8tcxK9Vq1bUqVOHp59+mqAg/xy8oIlCFVrGGD5dE8Or30aTkuaiaGAA5UoEMXt0SxqElnE6POWlDh8+zIMPPsjQoUMZPnw448aNczokj9NEoQqdBVuOsnDbMZbsOklymosyxYP4/MHWNAkr63Royou5XC6mTJnC888/jzGG++67z+mQCowmClUo/LL7JHPXxrDh8DlOJ6QAcMvNpahXJYTX721IKS2/rXKxe/duxowZw4oVK+jWrRvTpk2jRo0aTodVYPSvQ/ktYwxz1sbw9cY41h8+B1h9DyPa1ODpu27T5KDctnv3bnbs2MEnn3zC8OHDfe7G3hulfynKrxhj+HpTXEZ11vOJqQC0q1ORJ7veStPqOnJJuWfTpk1s3ryZkSNHcvfdd3PgwAHKli2czZOaKJTfOJOQTNTHa9keZz0zvVyJIIa1Cuflu+vryCXltqSkJF599VXeeustQkNDGTJkCMHBwYU2SYAmCuUH4i+n8NyXW1m04wQALWuWZ0ZUJKW1zpK6Tr/99hujR49m9+7djBw5knfeeUfrsKGJQvmwX/eeYsrS/azcfwaAVrXK069JKINuDyt0bcjqxsXFxdGpUydCQ0NZtGgR3bp1czokr6GJQvmcf68+zHs/7uHMJWv00k2li/FMt9sYeHuYw5EpXxQdHU1ERAShoaF8+eWXdOrUiVKlSjkdllfRRKF8woWkVN78fhefronJmNckrCyfjLxdK7aqPDl79ixPPvkks2bNYtmyZbRv354+ffo4HZZX0kShvNrFpFTmrInh9e93AdAwtAw3lS7G9GHN9dnRKs++/PJLHn30Uc6cOcMLL7xAixYtnA7Jq2miUF4nLj6Rf/y8l192n+TEheSM+Q92qMWEHvUcjEz5gxEjRjBr1iyaNWvGDz/8QJMmTZwOyetpolBeIy4+kT99s50lu05mzGsYWoY+jaswum0tHeKq8ixzEb82bdpQr149nnrqKYoU0VOgOzx6lESkO/B3IBCYYYx5I8vy6sAsoKy9zvPGmIWejEl5n81H4nnrh10Zo5fqVi7NmHa1GNBcn/qnbtzBgwcZN24cDzzwAFFRUYWiiF9+81iiEJFAYBLQFYgF1onIfGNMdKbVXgQ+N8ZMEZEIYCFQw1MxKe+SnJbOhK+28dXGOADKlgjijXsb0r1BFYcjU/4gPT2dSZMmMWHCBAICArj//vudDslnefKKogWwzxhzAEBE5gJ9gcyJwgAh9vsywFEPxqO8yMmLSfSfspIjZxO5rVJp/j6kCXUrh1z7g0q5YefOnYwePZpVq1bRo0cPpk6dSvXq1Z0Oy2d5MlGEAkcyTccCLbOs8zKwWET+DygJdMluQyIyDhgH6H+2j9sed55pyw/wU/QJElPTaVytDPMea+t0WMrP7Nu3j927dzN79mzuv/9+vQHzBnkyUWT3P2OyTA8BPjHGvCMirYHZItLAGOO66kPGTAemA0RGRmbdhvIBcfGJvLN4d0YzU3BQAJPvb0bPhtrMpPLHhg0b2LJlC6NGjaJPnz4cPHiQkBC9Ss0PnkwUsUDmW2Wr8b9NS6OB7gDGmFUiEgxUBE6i/MJP0Sf4bP0Rfoy26jAVKxLAP4c2o2tEJYcjU/4iMTGRV155hbfffpuwsDCGDh1KcHCwJol85MlEsQ6oIyI1gThgMDA0yzoxQGfgExGpBwQDpzwYkyoAKWkuvtkUx5y1MWw+Eg9Ax9tu4p6mofRtEupwdMqfLF++nDFjxrB3715Gjx7N22+/rUX8PMBjicIYkyYijwGLsIa+fmSM2SEirwLrjTHzgaeAD0XkCaxmqRHmyoBn5XPS0l18sGQfH/y8N2NeRJUQpg1rTlj5Eg5GpvxRXFwcnTt3JiwsjJ9++onOnTs7HZLfEl87L0dGRpr169c7HYbKYmtsPPd/uIaLyWkA9G5UhYn3NiRES32rfLZt2zYaNmwIwLfffkunTp0oWbKkw1F5PxHZYIyJzMtn9bZEdUNS0lw888UW5m22up/q3FyKb8e3pViRQIcjU/7m9OnTPPHEE/z73//OKOLXu3dvp8MqFDRRqDwxxjDpl328vXhPxrz/jG1F69oVHIxK+SNjDP/973957LHHOHfuHC+99BItW2Ydaa88SROFui6JKen8/ee9fPjrAdJdVrNln8ZV+WBwEx2rrjwiKiqK2bNnExkZyc8//5zR7KQKjiYK5bb9pxLo/cEKElPTARjSIoyX+tQnOEibmVT+ylzEr0OHDjRq1Ig//OEPWsTPIXrU1TUdjU/k5fk7WGzfC9E4rCz/fbA1RYvo8yBU/jtw4ABjx47lgQceYOTIkYwePdrpkAo9/UtXufp+2zHavLEkI0l8+39tmffoHZokVL5LT0/n/fffp2HDhqxbt46AAP0d8xZ6RaGyZYxh8tL9/G3RbooECBN61mN025pOh6X8VHR0NKNGjWLNmjX06tWLqVOnUq2alpn3Fpoo1FVS0128s3gPH604SEq6i5DgIix9phPlS+pzqZXnHDx4kP379zNnzhwGDx6sAyO8jCYKleFMQjKDpq9m38kEyhQP4rG2tzCufS3trFYesW7dOjZv3szYsWPp1asXBw4coHTp0k6HpbKhiUIBVnXXgVNXERefyJAWYUy8p6F+q1MecfnyZf785z/z3nvvER4ezrBhwwgODtYk4cW0t0ixfM8p7nhjCXHxifyxZ11ev7eRJgnlEUuXLqVRo0a88847jB07lk2bNmkRPx+gVxSF3D9+3ss7P1p3Vw9oXo1x7Ws7HJHyV7GxsXTt2pXw8HCWLFlCp06dnA5JuUkTRSH29H+38MWGWEoWDeSHP7TXCq/KI7Zs2ULjxo2pVq0a8+bNo2PHjpQoob9rvkSbngqhpNR0Hp2zkS82xALw2/N3apJQ+e7UqVMMHTqUJk2asGzZMgB69uypScIH6RVFIZKW7uLxzzbz3dZjGfN2/aW7jmpS+coYw9y5cxk/fjznz5/nlVdeoXXr1k6HpW6AJopCIiE5jRZ//YnLKVadpj/3jmDkHTW001rlu2HDhvHpp5/SsmVLZs6cSf369Z0OSd0gTRSFgDGGoR+u5nJKOg+0qs5r/bT6pspfLpcLEUFE6NSpE82bN2f8+PEEBurVqj+4Zh+FiBQXkQkiMtWevkVEeng+NJUfXC7DfVNXsTX2PIAmCZXv9u3bR+fOnfn4448BGD16NE888YQmCT/iTmf2R4AAbe3po8BEj0Wk8lXUx2tZf/gcxYoEcGBiT6fDUX4kLS2Nt99+m4YNG7Jp0yaKFtUyL/7KnaanOsaYISJyH4Ax5rJow7ZP+HnnCX7dexqA6Fe7ExCg/20qf2zfvp2RI0eyfv16+vbty+TJk6latarTYSkPcSdRpIhIMGAARKQmkOLRqNQN2XviIu/+uIfvtx8HYPWEzgRqklD5KCYmhsOHDzN37lwGDhyogyL8nDuJ4i/AD0A1EZkFdADGeDQqlWffbj3KY3M2AVCxVDH+3CeCymW0RIK6cWvWrGHLli2MGzeOnj17cuDAAUqVKuV0WKoAXDNRGGO+F5H1QBusvopnjDEnPR6Zum7/WnWIP8/bAcDHI2+n0203OxuQ8guXLl3iT3/6E++//z61atUiKiqKYsWKaZIoRK6ZKERksTGmGzAvm3nKC5xPTOWJzzazZJeVv396sj233KyVONWNW7JkCWPHjuXAgQM8/PDDvPHGGxQrVszpsFQByzFRiEhRIBioJCKlsa4mAEKA6gUQm3LDhsNn6T9lVcb02hc6c3NpbWpSNy42Npa77rqLmjVrsmzZMtq3b+90SMohuV1RPAo8CdwM7OD3RHEBmOrhuNQ1uFyG93/awwdL9gEQ1Tqcl++ur52K6oZt2rSJpk2bUq1aNRYsWECHDh0oXry402EpB+V4H4Ux5j1jTBjwnDGmujEmzH7VN8a8X4Axqmw89+XWjCTx+YOteaVvA00S6oacOHGCQYMG0axZs4wift27d9ckodzqzH5fROoCEVhNUVfmz/FkYCp7iSnpPPLpBn7ZfQrQon7qxhlj+PTTT3n88cdJSEjgtddeo02bNk6HpbyIO53ZLwLdgLrAIuAuYAWgiaKAbTh8jv5TVmZM73xVk4S6cUOHDmXu3Lm0bt2amTNnUq9ePadDUl7GnfsoBgFNgI3GmGEiUgWY5tmwVFax5y4z9l/rAZjQoy7j2tfSpiaVZ5mL+HXr1o3WrVvz6KOPan0mlS13EkWiMSZdRNLs0U/HgVoejktl8vm6Izz75VYA/npPA+5vGe5wRMqX7dmzh7FjxzJ8+HBGjx7NyJEjnQ5JeTl3igJuEpGyWMUB1wNrgY0ejUplSE13ZSSJd+5rrElC5VlaWhpvvfUWjRs3ZuvWrdpJrdyW6xWFXfwokBpiAAAgAElEQVTvZWNMPDBJRBYBIcYYTRQF4EJSKj3e/xWAV+6uT//m1RyOSPmqrVu3MmrUKDZs2MA999zDpEmTqFKlitNhKR+Ra6IwxhgR+RZobk/vK5CoVMbDhuLiExnSojpRbWo4HZLyYbGxsRw5coT//ve/9O/fX/u31HVxp+lprYg0y8vGRaS7iOwWkX0i8nwO6wwUkWgR2SEiOpIKOHkhiYYvL2Z73AXqVQnh9Xv1YUPq+q1cuZKpU617Y68U8RswYIAmCXXd3EkUbbGSxW4R2Sgim0Tkmk1PIhIITAJ6YN2DMUREIrKsUweYANxhjKkP/OG6fwI/k5LmYsDUVSQkp9G6VgUWjm977Q8plUlCQgKPP/44bdu25Z133iE5ORmAkiVLOhyZ8lXujHrql8dttwD2GWMOAIjIXKAvEJ1pnbHAJGPMOYDCXpU25sxlBk1fxbHzSdzduCofDGnqdEjKxyxevJhx48YRExPDo48+ysSJE7WIn7ph7tyZvT+P2w4FjmSajgVaZlnnVgAR+Q0IxOo4/yHrhkRkHDAOoHp1/61H2H/qSk5dTKZLvZt5f1ATp8NRPubIkSP06tWL2rVrs3z5ctq21atRlT/caXrKq+waQk2W6SJAHaAjMASYYQ/FvfpDxkw3xkQaYyJvuummfA/UGzw6ZyOnLiYzrFU4M6Ju18eWKrdt2LABgLCwMBYuXMjmzZs1Sah85clEEQuEZZquBhzNZp15xphUY8xBYDdW4ig09p9KYOTHa/lu6zEAXuoTcY1PKGU5fvw49913H5GRkRlF/Lp27UpwsJaZV/nLrUQhItVEpJP9vpiIuNMrtg6oIyI17WdbDAbmZ1nnG+DKditiNUUdcDd4XzdzxUE6v7Mso8DfjlfuokigJ3O38gfGGGbNmkVERAQLFixg4sSJWsRPeZQ7RQFHAY8BZYDaQDgwGeiS2+eMMWki8hhWIcFA4CNjzA4ReRVYb4yZby/rJiLRQDrWY1bP3MgP5CvWHTrLX761+vU/GhHJnXUrORyR8hWDBw/m888/54477mDGjBnUrVvX6ZCUnxNjsnYbZFlBZDPWCKY1xpim9rytxphGBRDf/4iMjDTr1693Ytf55tj5RDr+bSnJaS6WPNWBWjfps4dV7jIX8Zs1axYXL17kkUceISBAr0CVe0RkgzEmMi+fdee3LMkYk5JpZ4Fk31Gt3HApOY07315GcpqLRzvV1iShrmnXrl20b9+emTNnAhAVFcVjjz2mSUIVGHd+034TkWeBYLuf4jPgW8+G5b+GzVxDYmo6g28P45m7tMlA5Sw1NZWJEyfSuHFjoqOjKVVKv1QoZ7iTKJ4FLgK7gMeBn4EXPBmUv/p261E2xsQTVr64luVQudq8eTMtWrTghRde4O677yY6OprBgwc7HZYqpNy5M7snMMMYM8XTwfizo/GJ/PGrbQB8N76d1ttRuTp+/DjHjx/nyy+/5N5773U6HFXIuXNFMRDYJyIfi8hddh+Fug7rD52l23vLuZCUxtv3NSYkOMjpkJQXWrFiBZMnTwage/fu7N+/X5OE8grXTBTGmGFY9zcsAEYBB0RkqqcD8xdJqekZRf4m3tOQAfpMCZXFxYsXeeyxx2jXrh3vv/9+RhG/EiVKOByZUha3hk0YY5KBecAnWDfSDfRgTH7lynOuH+5Ym6Et/bdOlcqbRYsW0aBBAyZPnszjjz/Oxo0btYif8jru3HDXBeuu6i7Ab8C/gKEejssv/LD9GL/uPQ3Ac911hJO62pEjR+jduze33HILK1as0LurlddypzP7IWAu8H/GmEQPx+M35m2O4/G5mwH49dlODkejvIUxhnXr1tGiRQvCwsL4/vvvadu2rdZnUl7NnT6KAcaYLzRJuG/2qkM8PnczxYMC+eqRNoSV17ZmBceOHaN///60bNkyo4hfly5dNEkor5fjFYWILDPGdBCRc1xdHlywHqdd3uPR+aATF5L407wdAHw3vq3eea0wxvDJJ5/w5JNPkpSUxJtvvskdd9zhdFhKuS23pqcr7SUVCyIQfzHO7rz+6z0NNEkoAAYOHMgXX3xBu3btmDFjBrfeeqvTISl1XXJsejLGuOy3M40x6ZlfwMyCCc+3LNpxnC2x57mveTXubxnudDjKQenp6bhc1p9Qnz59mDx5MkuXLtUkoXySO8Njr6oSa99wd7tnwvFdSanpPP35FgBe7K0PHyrMdu7cSbt27TKK+A0fPpyHH35Yi/gpn5Xjb66IPGf3TzQSkbP26xxwClhYYBH6gHSX4eF/b+Bichp9GlelTHG987owSk1N5bXXXqNJkybs3r2bMmXKOB2SUvkitz6Kt4B3gNeB56/MtJuelM3lMvSdtILtcRcA+MeQpg5HpJywadMmRowYwdatWxk0aBAffPABN998s9NhKZUvcksUtxhj9orIbKD+lZlXitkZY7Z6ODafMG35gYwksfevPRyORjnlxIkTnD59mm+++Ya+ffs6HY5S+Sq3RPE8MBqYlM0yA7T3SEQ+JCk1nTd/2AXAgYk9CQjQirCFyfLly9m2bRuPPvoo3bt3Z9++fRQvXtzpsJTKdzkmCmPMaPvfdgUXjm/549dW2fAhLcI0SRQiFy5c4Pnnn2fKlCnceuutjBkzhmLFimmSUH7rmsMwROReESltv39eRD4XkcaeD827Ldl1gq82xgHw1376EKLCYuHChdSvX59p06bx5JNPahE/VSi4M17vZWPMRRFpA/TBehTqNM+G5d3S0l386Rvr7utfn+2kVxOFxJEjR+jbty9lypRh5cqVvPPOO5QsWdLpsJTyOHcSxZVRTr2BycaYL4FC/RXquS+3ERefyKOdamsdJz9njGH16tUAhIWFsXjxYjZu3EjLli0djkypguNOojgmIpOwSo0vFJGibn7OL32+7ghfboylWfWyPNX1NqfDUR509OhR+vXrR+vWrTOK+HXq1ImiRYs6HJlSBcvdR6EuA3oaY85h1X56PveP+Kfj55N4ab7V5PTpmFba5OSnjDHMmDGDiIgIFi9ezNtvv61F/FShds3nURhjEkQkGugoIh2BX40x33s8Mi9zOSWNdm8tITXd8HKfCIoX1UeH+6sBAwbw1Vdf0aFDB2bMmMEtt9zidEhKOcqdUU+PAZ8D1e3X5yLyiKcD8zZvfr+L1HTDiDY1GHFHTafDUfkscxG/fv36MXXqVJYsWaJJQilAjDG5ryCyFWhjjEmwp0sBK40xjXL9oIdERkaa9evXF+g+Lyal0vDlxZQvWZSNf+paoPtWnrd9+3bGjBnD6NGjGTt2rNPhKOURIrLBGBOZl8+600chQGqm6VR7XqHgchkGTbNGvTzXXTuv/UlKSgqvvPIKzZo1Y//+/ZQrV87pkJTySu48M3s2sFpEvsRKEP2AWR6Nyov8svsk0ccuUK5EEAMjw5wOR+WTDRs2MGLECLZv387QoUN5//33uemmm5wOSymv5E5n9lsi8gtwpZTHQ8aYdZ4Ny3t8sGQfAMue7ZRREFH5vjNnzhAfH8+CBQvo3bu30+Eo5dXcuaIASLZfLvvfQiH23GW2HIknMrwcIcH6jAlf98svv7Bt2zbGjx9Pt27d2Lt3L8HBwU6HpZTXc2fU0wvAf4AqQDVgjohM8HRg3uCjFYcAeLZ7XWcDUTfk/PnzPPjgg9x5551MmTKF5GTru44mCaXc405n9gPA7caYF40xLwAtgOGeDct5F5JS+ffqw9xWqTQtapZ3OhyVRwsWLCAiIoIZM2bw9NNPs2HDBi3ip9R1cqfp6XCW9YoABzwTjveYtGQfKekuHu5Y2+lQVB4dOXKE/v37U7duXb755htuv10f9a5UXriTKC4DO0RkEdYDi7oBK0TkXQBjzJMejM8RSanpTFt+gDLFg+jbpKrT4ajrYIxh1apVtGnTJqOIX5s2bbQ+k1I3wJ2mp++Al4FVwGrgVWAJsMN+5UhEuovIbhHZJyI51ocSkQEiYkQkTzeD5Lfx/9kEwD1NQ3Wkkw+JjY3l7rvv5o477sgo4texY0dNEkrdIHeGx87My4ZFJBDrMapdgVhgnYjMN8ZEZ1mvNDAeWJOX/eS3I2cvszj6BDUrluTlu+tf+wPKcS6Xiw8//JBnnnmGtLQ03n33Xdq2bet0WEr5DU+WC28B7DPGHDDGpABzgeyeOv8X4C0gyYOxuG3a8v0AvDXAkQolKg/69+/PQw89xO2338727dt54oknCAzUoo1K5RdPJopQ4Eim6Vh7XgYRaQqEGWO+zW1DIjJORNaLyPpTp07lf6S2C0mpfLbuCKFlixMZruUcvFlaWlpGEb/+/fvz4Ycf8tNPP1GrVi2HI1PK/7idKETkescUZte4n1GBUEQCgPeAp661IWPMdGNMpDEm0pNlFv7x815S0w0v9qqnfRNebOvWrbRu3ZoPP/wQgAceeIAxY8bo/5lSHuLODXctRGQbsNeebiwi/3Bj27FA5uJI1YCjmaZLAw2ApSJyCGgFzHeqQ/vg6Ut8+OtBAO6qX9mJENQ1JCcn89JLL9G8eXMOHz6stZmUKiDuDI/9AOt52d8AGGO2iEgnNz63DqgjIjWBOKxHqQ69stAYcx7raXkAiMhS4GljTMHWEMeqEPvEZ5sBeH9QE31ynRdat24dI0aMIDo6mmHDhvHee+9RoUIFp8NSqlBwJ1EEGGMOZ7msT7/Wh4wxafZDjxYBgcBHxpgdIvIqsN4YMz9PEXvAp2tj2Hwknu71K9Ovaei1P6AK3Llz50hISGDhwoX06NHD6XCUKlTcSRRHRKQFYOwhr/8H7HFn48aYhcDCLPP+nMO6Hd3Zpid8vTEWgEn3N3MqBJWNJUuWsG3bNh5//HG6devGnj17tPyGUg5wpzP7YeBJrMegnsDqS3jYk0EVpGPnE9kYE0+7OhUJ1CYnrxAfH8/YsWPp3Lkz06ZNyyjip0lCKWdcM1EYY04aYwYbYyrar8HGmNMFEVxBeGmedXO51nTyDvPmzSMiIoKPPvqIZ599Vov4KeUFrtn0JCIfkmlY6xXGmHEeiagAfb0plsXRJ7i3WShtale89geUR8XExHDfffdRr1495s+fT2SkV1R0UarQc6eP4qdM74OBe7j6RjqfZIzh7UVWV8tr/Ro4HE3hZYxhxYoVtGvXjurVq/PTTz/RqlUrrc+klBdxp+nps0yvWcC9QITnQ/OsxdEniItPZESbGpQo6u6D/lR+iomJoVevXrRv3z6jiF/79u01SSjlZfJSwqMmEJ7fgRS0RduPA/CHLnUcjqTwcblcTJ48mfr167N8+XI++OADLeKnlBdzp4/iHL/3UQQAZ4EcS4b7ir0nEwgJLkLZEvrttaDde++9zJs3j65duzJ9+nRq1KjhdEhKqVzkmijEusuuMdad1QAuY8z/dGz7mrj4RLbFnee+5tWcDqXQSEtLIyAggICAAAYNGkTfvn0ZMWKE1mdSygfk2vRkJ4WvjTHp9svnkwTAXxZYj8QY004rjRaELVu20LJlS6ZPnw7AkCFDGDlypCYJpXyEO30Ua0XEb25ZPnEhiR92HKd4UCC3VS7tdDh+LSkpiRdffJHIyEhiY2OpXFmLLSrli3JsehKRIsaYNKAtMFZE9gOXsMqHG2OMTyaPL+1yHR+NuN3hSPzb2rVriYqKYteuXURFRfHuu+9Svnx5p8NSSuVBbn0Ua4FmQL8CisXjXC7DnDUxVA4JpnVtrTzqSRcuXCAxMZEffviBu+66y+lwlFI3ILdEIQDGmP0FFIvHfb0pjthziQyM1E5sT1i8eDE7duzgiSeeoEuXLuzevVvLbyjlB3JLFDeJyJM5LTTGvOuBeDzGGMM/f9kHwKt99U7s/HTu3DmefPJJPvnkE+rXr88jjzxCsWLFNEko5Sdy68wOBEphPYkuu5dP+X77cQ6evsSD7WsRHBTodDh+46uvviIiIoLZs2czYcIE1q9frwlCKT+T2xXFMWPMqwUWiYd98PNeAJ7sdqvDkfiPmJgYBg8eTIMGDVi4cCFNmzZ1OiSllAfkdkXhN4Pct8bGs+v4RUbdUZNiRfRq4kYYYzLqMlWvXp0lS5awZs0aTRJK+bHcEkXnAovCw174ejsAj3TSZ07ciMOHD9OjRw86duyYkSzatm1LUFCQw5EppTwpx0RhjDlbkIF4ys5jF9gWd566lUtTsZS2neeFy+Xin//8J/Xr12fFihX84x//oF27dk6HpZQqIH5fX/vH6BMATB+mD8HJq379+rFgwQLuuusupk2bRni4zxcPVkpdB79PFD/tPEHlkGCqVyjhdCg+JTU1lcDAQAICAhgyZAgDBgxg2LBhWp9JqUIoL8+j8Blx8YlsjT1Pv6ahTofiUzZu3EiLFi2YOnUqYBXxGz58uCYJpQopv04U8zZb1dF7NtRidO5ITExkwoQJtGjRguPHjxMWFuZ0SEopL+DXTU+zVx2mRoUSNAwt43QoXm/16tVERUWxZ88eRo0axdtvv025cuWcDksp5QX8NlGsOXCGY+eTeLFXPW0yccOlS5dITU3lxx9/pEuXLk6Ho5TyIn6bKD5dE0NQoHBfc20+yckPP/zAjh07eOqpp+jcuTO7du2iaFF9NKxS6mp+2UeRkuZi0Y7jtKpVgTIl9GawrM6cOUNUVBQ9evRg1qxZpKSkAGiSUEplyy8TRfSxCySnuejZsIrToXgVYwxffPEFERERzJkzhxdffJF169ZpglBK5covm55+2XUSgDvr3uxwJN4lJiaGoUOH0qhRIxYvXkzjxo2dDkkp5QP88orix+gTlCsRRKWQYKdDcZwxhiVLlgAQHh7O0qVLWb16tSYJpZTb/C5RnLqYTPSxC4y6o6bToTju4MGDdOvWjc6dO2cU8WvTpg1FivjlhaRSykP8LlGsO2TVMmxRs7zDkTgnPT2dv//97zRo0IA1a9YwZcoULeKnlMozv/tquWDLUYoWCaBZeOG9Waxv375899139OzZk6lTp+od1kqpG+JXieJ8Yirfbz9O21sqEhTodxdLucpcxG/YsGEMGTKEoUOH6s2GSqkb5tGzqYh0F5HdIrJPRJ7PZvmTIhItIltF5GcRuaH61WsOnAFgVNsaN7IZn7N+/XoiIyOZMmUKAIMGDeL+++/XJKGUyhceSxQiEghMAnoAEcAQEYnIstomINIY0wj4AnjrRva5OPoEJYsG0qZ2xRvZjM9ITEzkueeeo2XLlpw6dUqfE6GU8ghPXlG0APYZYw4YY1KAuUDfzCsYY34xxly2J1cD1W5kh6sPnKFOpdIEB/n/c7FXrVpF48aNeeuttxg1ahTR0dH07t3b6bCUUn7Ik30UocCRTNOxQMtc1h8NfJ/dAhEZB4wDqF69erYfPnEhidhzifRvdkO5xmckJibicrn46aef6NzZbx5vrpTyQp5MFNk1kJtsVxR5AIgEOmS33BgzHZgOEBkZme02rjx74q76/vvsiYULF7Jjxw6eeeYZ7rzzTnbu3ElQkNayUkp5liebnmKBzOMyqwFHs64kIl2AF4C7jTHJed3Zpph4qpQJJqJqSF434bVOnz7NAw88QK9evfj0008zivhpklBKFQRPJop1QB0RqSkiRYHBwPzMK4hIU2AaVpI4mdcdpbsMS3efolE1/3pAkTGGuXPnUq9ePT7//HNeeukl1q5dq0X8lFIFymNNT8aYNBF5DFgEBAIfGWN2iMirwHpjzHzgb0Ap4L/2UM4YY8zd17uvTTHnSExNp+Nt/lUEMCYmhqioKBo3bszMmTNp2LCh0yEppQohj95wZ4xZCCzMMu/Pmd7ny6PUNhw+B0DH227Kj805yhjDzz//TJcuXQgPD2fZsmXcfvvtBAb6/0gupZR38ovbl7fFnadCyaJUKVPc6VBuyP79++ncuTNdu3bNKOLXqlUrTRJKKUf5fKJITEnn550naVvHd2+yS09P591336Vhw4Zs2LCBadOmaRE/pZTX8PlaTxvt/glffppdnz59+P777+nduzdTpkyhWrXCcS+IUso3+Hyi+HXvaQIEWteu4HQo1yUlJYUiRYoQEBDAiBEjGDZsGIMHD9b6TEopr+PzTU+r9p+mYbWyhAT7zj0Fa9eupXnz5kyePBmAgQMHMmTIEE0SSimv5NOJwuUy7DuZQGMfuX/i8uXLPPXUU7Ru3Zpz585Ru3Ztp0NSSqlr8ummp+hjF7iUkk5EFe+/G3vFihVERUVx4MABHnzwQd58803KlPGNBKeUKtx8OlGstp8/0cEH7p+48mChX375hY4dOzodjlJKuc2nE8XhM5cpXawIlUOCnQ4lWwsWLGDnzp08++yzdOrUiejoaIoU8elDrpQqhHy6j2L3iYtUr1DC6zqBT506xdChQ7n77rv5z3/+k1HET5OEUsoX+WyiSEt3sfHwOVrULO90KBmMMcyZM4d69erxxRdf8Oqrr7JmzRot4qeU8mk++xV31/GLpLkM9byoIzsmJoaRI0fStGlTZs6cSf369Z0OSSmlbpjPXlEcOWs9QfXWSqUdjcPlcrFo0SIAwsPD+fXXX/ntt980SSil/IbPJoqF249TtEgAtzmYKPbu3cudd95J9+7dWb58OQAtWrTQIn5KKb/is4lie9x52t5SkeJFC/6knJaWxt/+9jcaNWrE5s2bmTlzphbxU0r5LZ/sozDGcPJCEh1udeb+id69e7No0SL69u3L5MmTqVq1qiNxKKVUQfDJRHH4zGUupaRT+6aSBbbP5ORkgoKCCAgIYMyYMYwaNYr77rvP64bmKqVUfvPJpqcrd2Q3DitbMPtbvZpmzZoxadIkAAYMGMDAgQM1SSilCgWfTBSbYuIpViTA4zWeLl26xBNPPEGbNm24ePEiderU8ej+lFLKG/lk09O6Q2dpUbM8RQI9l+d+/fVXoqKiOHjwII888givv/46ISHec8+GUkoVFJ9LFC4Dh85concjzz7RLi0tjaCgIJYtW0b79u09ui+llPJmPpcoktPScRk8ckf2N998w86dO5kwYQKdOnVix44dWp9JKVXo+VwfRWqaC4CqZYvn2zZPnDjBwIEDueeee/jiiy+0iJ9SSmXic4ki2U4UNSre+NBYYwyzZ88mIiKCefPm8de//pXVq1drET+llMrE574yJ6WmE166GGWK3/gzsmNiYhgzZgyRkZHMnDmTunXr5kOESinlX3zyiqJOpVJ5/rzL5eL7778HrCJ+v/32G8uXL9ckoZRSOfDJRFGrYt4SxZ49e+jYsSM9e/Zk2bJlAERGRmoRP6WUyoXPJQqXMYSWu76O7LS0NN58800aNWrEtm3b+Pjjj3XIq1JKucnn+igAqpcvcV3r9+rVi8WLF3PvvfcyadIkKleu7KHIlFLK//hkoihf8tqjkpKSkggKCiIwMJBx48Yxbtw4+vfvXwDRKaWUf/G5pieAkODcRzz99ttvNGnSJKOIX//+/TVJKKVUHvlkoigdnP2FUEJCAuPHj6ddu3YkJSVRr169Ao5MKaX8j082PYVkcw/FsmXLiIqKIiYmhscee4yJEydSqlTeh9EqpZSy+FyiECAkhyuKEiVK8Ouvv3LHHXcUbFBKKeXHxBjjdAzXpWToreZS3B4AvvrqK3bt2sUf//hHANLT0/WeCKWUyoaIbDDGROblsx7toxCR7iKyW0T2icjz2SwvJiKf2cvXiEgNN7bJ8ePHGTBgAP379+frr7/OKOKnSUIppfKfxxKFiAQCk4AeQAQwREQisqw2GjhnjLkFeA9481rbdbnSqVevHt9++y2vv/46K1eu1CJ+SinlQZ68omgB7DPGHDDGpABzgb5Z1ukLzLLffwF0lms8iDotNZUGDRqwZcsWnn/+eYKCbrw4oFJKqZx5sjM7FDiSaToWaJnTOsaYNBE5D1QATmdeSUTGAePsyeQVK2K2axE/ACqS5VgVYnosfqfH4nd6LH53W14/6MlEkd2VQdaec3fWwRgzHZgOICLr89oh42/0WPxOj8Xv9Fj8To/F70RkfV4/68mmp1ggLNN0NeBoTuuISBGgDHDWgzEppZS6Tp5MFOuAOiJSU0SKAoOB+VnWmQ9E2e8HAEuMr43XVUopP+expie7z+ExYBEQCHxkjNkhIq8C640x84GZwGwR2Yd1JTHYjU1P91TMPkiPxe/0WPxOj8Xv9Fj8Ls/HwuduuFNKKVWwfLIooFJKqYKjiUIppVSuvDZReKL8h69y41g8KSLRIrJVRH4WkXAn4iwI1zoWmdYbICJGRPx2aKQ7x0JEBtq/GztEZE5Bx1hQ3PgbqS4iv4jIJvvvpKcTcXqaiHwkIidFZHsOy0VEPrCP01YRaebWho0xXvfC6vzeD9QCigJbgIgs6zwCTLXfDwY+czpuB49FJ6CE/f7hwnws7PVKA8uB1UCk03E7+HtRB9gElLOnb3Y6bgePxXTgYft9BHDI6bg9dCzaA82A7Tks7wl8j3UPWytgjTvb9dYrCo+U//BR1zwWxphfjDGX7cnVWPes+CN3fi8A/gK8BSQVZHAFzJ1jMRaYZIw5B2CMOVnAMRYUd46FAULs92X433u6/IIxZjm534vWF/iXsawGyopIlWtt11sTRXblP0JzWscYkwZcKf/hb9w5FpmNxvrG4I+ueSxEpCkQZoz5tiADc4A7vxe3AreKyG8islpEuhdYdAXLnWPxMvCAiMQCC4H/K5jQvM71nk8A731wUb6V//ADbv+cIvIAEAl08GhEzsn1WIhIAFYV4hEFFZCD3Pm9KILV/NQR6yrzVxFpYIyJ93BsBc2dYzEE+MQY846ItMa6f6uBMcbl+fC8Sp7Om956RaHlP37nzrFARLoALwB3G2OSCyi2gnatY1EaaAAsFZFDWG2w8/20Q9vdv5F5xphUY8xBYDdW4vA37hyL0cDnAMaYVUAwVsHAwsat80lW3pootPzH7655LOzmlmlYScJf26HhGsfCGHPeGFPRGFPDGJRlw3oAAATJSURBVFMDq7/mbmNMnouheTF3/ka+wRrogIhUxGqKOlCgURYMd45FDNAZQETqYSWKUwUapXeYDwy3Rz+1As4bY45d60Ne2fRkPFf+w+e4eSz+BpQC/mv358cYY+52LGgPcfNYFApuHotFQDcRiQbSgWeMMWeci9oz3DwWTwEfisgTWE0tI/zxi6WI/AerqbGi3R/zEhAEYIyZitU/0xPYB1wGRrq1XT88VkoppfKRtzY9KaWU8hKaKJRSSuVKE4VSSqlcaaJQSimVK00USimlcqWJQnktEUkXkc2ZXjVyWbdGThUzC5qIRIrIB/b7jiLSJtOyh0RkeAHG0sRfK6WqguOV91EoZUs0xjRxOojrZd/gd+Umv45AArDSXjY1v/cnIkXsemfZaYJV1mVhfu9XFR56RaF8in3l8KuIbLRfbbJZp76IrLWvQraKSB17/gOZ5k8TkcBsPntIRN6011srIrfY88PFetbHlWd+VLfn3yci20Vki4gst+d1FJFv7Sugh4An7H22E5GXReRpEaknImuz/Fxb7ffNRWSZiGwQkUXZVfcUkU9E5F0R+QV4U0RaiMhKsZ63sFJEbrPvUn4VGGTvf5CIlBTrmQXr7HWzq76r1NWcrp+uL33l9MK6m3iz/franlcCCP7/9u4lJKowCuD4/2BTSZAR2KaIMHrTAwrCXVC0CQIrmoXPokWbikCIsCIQei6CEtdKUFgkgW5MwojUpI1lD0qKNhGBO3ETxGlxjnltZi7jSsXzg+GeO3O/e79hFsfvft7zebwBe/IWYB1egx+4B1R7vBgoBbYAXUDG328F6vJc8zvQ5HEd0O1xF1Dv8UngqccjwGqPV/h2X6LdVaAxcf5/+/69Kjy+AFzCnqIdAMr9/Sz2pPH//WwDuoES318OLPL4APDE4wagJdHuGlAz2V/gC7Bstn/reM3tV9x6CnNZvltPGaBFRHZhiWRjnnaDQJOIrAE6VXVURPYDu4E3XuakFChUF+thYnvH40rgiMf3sfUuAPqBNhF5BHTO5MthReqOAzewhJAFNmGFDXu9nyVAoVo8j1X1j8dlQLuPnhQv25DHQeCwiDT6/lJgLfBphn0PC0gkijDfnAd+ATuxW6c5ixOp6gMRGQIOAT0icgorr9yuqheLuIYWiHOOUdXTIrLXrzXsCaxYHVh9rk47lY6KyHbgg6pWFtF+IhE3A32qWuW3vF4UaCPAUVX9PIN+hgUu5ijCfFMG/FRbR6AW+4t7GhGpAL6p6l2sWuYO4DlwTERW+TErpfDa4tnEdtDjAaYKT1YDr/w861V1SFWvAGNML+EMMI6VP8+hql+xUdFlLGmAlQIvF1szARHJiMi2Av1MKgN+eNyQcv0e4Iz4cEWs8nAIqSJRhPmmFagXkdfYbaeJPMdkgfciMgxsxpZ+/IjNATzzSeNeoNASkEt8RHIOG8EAnAVOeNta/wzgtoiM+L/mvsTWa07qAqomJ7PzXKsDqGFqrYTfWNn8myLyFpvHyJmwz+MWcF1E+pmePPuArZOT2djIIwO88z43F3HusMBF9dgQEsQWPNqjqmOz3ZcQ5ooYUYQQQkgVI4oQQgipYkQRQgghVSSKEEIIqSJRhBBCSBWJIoQQQqpIFCGEEFL9BWJSvH+UxAILAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<matplotlib.figure.Figure at 0x1512555dd8>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# plot ROC curve\n",
    "plt.xlim(0, 1)\n",
    "plt.ylim(0.0, 1)\n",
    "plt.plot([0, 1], [0, 1], 'k--')\n",
    "plt.plot(fpr_rf, tpr_rf, label='RF')\n",
    "plt.xlabel('False positive rate')\n",
    "plt.ylabel('True positive rate')\n",
    "plt.title('ROC curve (zoomed in at top left)')\n",
    "plt.legend(loc='best')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[Parallel(n_jobs=-1)]: Done  42 tasks      | elapsed:   31.0s\n",
      "[Parallel(n_jobs=-1)]: Done 192 tasks      | elapsed:  2.5min\n",
      "[Parallel(n_jobs=-1)]: Done 200 out of 200 | elapsed:  2.6min finished\n",
      "[Parallel(n_jobs=4)]: Done  42 tasks      | elapsed:    0.5s\n",
      "[Parallel(n_jobs=4)]: Done 192 tasks      | elapsed:    2.0s\n",
      "[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    2.1s finished\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.6223198370658405\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[Parallel(n_jobs=-1)]: Done  42 tasks      | elapsed:   35.0s\n",
      "[Parallel(n_jobs=-1)]: Done 192 tasks      | elapsed:  2.2min\n",
      "[Parallel(n_jobs=-1)]: Done 200 out of 200 | elapsed:  2.3min finished\n",
      "[Parallel(n_jobs=4)]: Done  42 tasks      | elapsed:    0.5s\n",
      "[Parallel(n_jobs=4)]: Done 192 tasks      | elapsed:    2.1s\n",
      "[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    2.2s finished\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.7844909191190228\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[Parallel(n_jobs=-1)]: Done  42 tasks      | elapsed:   24.4s\n",
      "[Parallel(n_jobs=-1)]: Done 192 tasks      | elapsed:  2.0min\n",
      "[Parallel(n_jobs=-1)]: Done 200 out of 200 | elapsed:  2.0min finished\n",
      "[Parallel(n_jobs=4)]: Done  42 tasks      | elapsed:    0.5s\n",
      "[Parallel(n_jobs=4)]: Done 192 tasks      | elapsed:    2.2s\n",
      "[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    2.2s finished\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.7631062712262883\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[Parallel(n_jobs=-1)]: Done  42 tasks      | elapsed:   22.3s\n",
      "[Parallel(n_jobs=-1)]: Done 192 tasks      | elapsed:  1.7min\n",
      "[Parallel(n_jobs=-1)]: Done 200 out of 200 | elapsed:  1.8min finished\n",
      "[Parallel(n_jobs=4)]: Done  42 tasks      | elapsed:    0.5s\n",
      "[Parallel(n_jobs=4)]: Done 192 tasks      | elapsed:    2.1s\n",
      "[Parallel(n_jobs=4)]: Done 200 out of 200 | elapsed:    2.2s finished\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.7525708081212947\n"
     ]
    }
   ],
   "source": [
    "n_estimator=100\n",
    "rf = RandomForestClassifier(max_depth=3, n_estimators=n_estimator, n_jobs=-1, verbose=1)\n",
    "kf = cross_validation.KFold(yall.shape[0], n_folds=4)\n",
    "for train_index, test_index in kf:\n",
    "    #print(train_index)\n",
    "    X_train, X_test = x.iloc[train_index], x.iloc[test_index]\n",
    "    y_train, y_test = ysex[train_index], ysex[test_index]\n",
    "    rf.fit(X_train, y_train)\n",
    "    y_pred_rf = rf.predict_proba(X_test)[:, 1]\n",
    "    auc = roc_auc_score(y_test, y_pred_rf)\n",
    "    print(auc)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "试试随机森林映射，将样本分层产出one hot encoding，供Logistic Regression使用。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.linear_model import LogisticRegression\n",
    "from sklearn.pipeline import make_pipeline"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.7525708081212947\n",
      "CPU times: user 10.8 s, sys: 8.57 s, total: 19.4 s\n",
      "Wall time: 20.1 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "rt = RandomTreesEmbedding(max_depth=2, n_estimators=10, random_state=0, n_jobs=-1)\n",
    "rt_lm = LogisticRegression()\n",
    "pipeline = make_pipeline(rt, rt_lm)\n",
    "pipeline.fit(X_train, y_train)\n",
    "y_pred_rt = pipeline.predict_proba(X_test)[:, 1]\n",
    "auc = roc_auc_score(y_test, y_pred_rf)\n",
    "print(auc)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [],
   "source": [
    "def RFLR(X_train, y_train, X_test, y_test):\n",
    "    rt = RandomTreesEmbedding(max_depth=2, n_estimators=50, random_state=0, n_jobs=-1)\n",
    "    rt_lm = LogisticRegression()\n",
    "    pipeline = make_pipeline(rt, rt_lm)\n",
    "    pipeline.fit(X_train, y_train)\n",
    "    y_pred_rt = pipeline.predict_proba(X_test)[:, 1]\n",
    "    auc = roc_auc_score(y_test, y_pred_rt)\n",
    "    print(auc)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.7281274454649636\n",
      "0.7310772609377346\n",
      "0.7223336837599671\n",
      "0.7298428270705039\n",
      "0.7070573186415428\n",
      "CPU times: user 4min 17s, sys: 2min 26s, total: 6min 44s\n",
      "Wall time: 7min 18s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "kf = cross_validation.KFold(ysex.shape[0], n_folds=5, shuffle=True)\n",
    "for train_index, test_index in kf:\n",
    "    X_train, X_test = x.iloc[train_index], x.iloc[test_index]\n",
    "    y_train, y_test = ysex[train_index], ysex[test_index]\n",
    "    RFLR(X_train, y_train, X_test, y_test)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "进行PLS回归，求解x和y的分解，分解后的因子作为特征输入。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 2min, sys: 1min 31s, total: 3min 32s\n",
      "Wall time: 3min 18s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "pls2 = PLSRegression(n_components=7)\n",
    "pls2.fit(x1, y1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "(2267657, 7)\n",
      "CPU times: user 6.91 s, sys: 11 s, total: 18 s\n",
      "Wall time: 19.6 s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "x0_r, y0_r = pls2.transform(x1, y1)\n",
    "print(x0_r.shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.decomposition import TruncatedSVD"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "CPU times: user 1min 16s, sys: 47.3 s, total: 2min 3s\n",
      "Wall time: 1min 46s\n"
     ]
    }
   ],
   "source": [
    "%%time\n",
    "svd=TruncatedSVD(n_components=50)\n",
    "svd.fit(x1) \n",
    "u = svd.transform(x1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.6496398721740004\n",
      "0.2132827532195946\n",
      "0.09340869302925237\n",
      "-0.15741484291634114\n",
      "0.04550248732429194\n",
      "-0.008242077180567483\n",
      "0.03414483704741123\n"
     ]
    }
   ],
   "source": [
    "for i in range(7):\n",
    "    print(np.corrcoef(y1.iloc[:, 1].T, x0_r[:, i].T)[0, 1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.collections.PathCollection at 0x1512060940>"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<matplotlib.figure.Figure at 0x1511f17240>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "idx = np.random.choice(x0_r.shape[0], 1000)\n",
    "plt.scatter(y0_r[idx, 5], y1.iloc[idx, 1])"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
